import re
from transformers import AutoTokenizer, AutoModelForTokenClassification, pipeline


police_crime_types_input = ["рдкреБрд▓рд┐рд╕ рдХреА рд▓рд╛рдкрд░рд╡рд╛рд╣реА", "рдкреБрд▓рд┐рд╕ рджреНрд╡рд╛рд░рд╛ рдЕрдкрд░рд╛рдз", "рдЧрдВрднреАрд░ рдЕрдкрд░рд╛рдз", "рдХрд╛рдиреВрди рд╡реНрдпрд╡рд╕реНрдерд╛", "рд╡рд┐рднрд╛рдЧреАрдп рдирдХрд╛рд░рд╛рддреНрдордХ рд╕рдорд╛рдЪрд╛рд░"]
police_crime_examples = ["рд░рд┐рдкреЛрд░реНрдЯ рджрд░реНрдЬ рди рдХрд░рдирд╛", "рдЕрдкрд░рд╛рдзреА рдХреЛ рдЬрд╛рдирддреЗ рд╣реБрдП рднреА рдЙрд╕реЗ рдЧрд┐рд░рдлреНрддрд╛рд░ рди рдХрд░рдирд╛", "рд╢рд┐рдХрд╛рдпрдд рдкрд░ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдирд╣реАрдВ рдХрд░рдирд╛", "рдкреНрд░рд╛рд░реНрдереА/рдкреАреЬрд┐рддреЛрдВ/рдЧрд╡рд╛рд╣реЛрдВ рдХреЗ рд╕рд╛рде рджреБрд░реНрд╡реНрдпрд╡рд╣рд╛рд░", "рдЬреБрдЖ/рд╕рдЯреНрдЯреЗрдмрд╛рдЬреЛрдВ рдХреЛ рд╕рдВрд░рдХреНрд╖рдг рджреЗрдирд╛", "рдЖрдкрд╛рдд рд╕реНрдерд┐рддрд┐ рдореЗ рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрдирд╛", "рдЭреВрдареЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдирд┐рд░реНрджреЛрд╖ рдХреЗ рд╡рд┐рд░реВрджреНрдз рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдХрд░рдирд╛", "рдЖрд░реЛрдкреА рдХреЗ рд╕рд╛рде рдЕрдорд╛рдирд╡реАрдп рд╡реНрдпрд╡рд╣рд╛рд░", "рд░рд┐рд╢реНрд╡рдд/рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░ рдХрд░ рдЖрд░реЛрдкреА рдкрдХреНрд╖ рдХреЛ рд▓рд╛рдн рдкрд╣реБрдВрдЪрд╛рдирд╛", "рдЕрдкрд░рд╛рдз рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрд╕реЗ рдХреА рдорд╛рдВрдЧ рдХрд░рдирд╛", "рдХрд╛рдиреВрдиреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЕрдирджреЗрдЦреА рдХрд░рдирд╛", "рдиреНрдпрд╛рдпрд╛рд▓рдп рдХреЗ рдЖрджреЗрд╖реЛрдВ рдХрд╛ рдЕрд╡рд╣реЗрд▓рдирд╛ рдХрд░рдирд╛", "рдорд╛рджрдХ рдкрджрд╛рд░реНрдереЛрдВ рдХреА рддрд╕реНрдХрд░реА рдореЗрдВ рд╕рдВрд▓рд┐рдкреНрддрддрд╛", "рдЧреБрдгреНрдбрд╛/рдмрджрдорд╛рд╖реЛрдВ рдХреЛ рд╕рдВрд░рдХреНрд╖рдг рджреЗрдирд╛", "рдкреБрд▓рд┐рд╕ рдЕрдзрд┐рдХрд╛рд░реА/рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░рд┐рдд рдЕрдкрд░рд╛рдз", "рдЕрд╡реИрдз рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЕрдирджреЗрдЦрд╛ рдХрд░рдирд╛", "рд╕рд╛рдореНрдкреНрд░рджрд╛рдпрд┐рдХ рд╣рд┐рдВрд╕рд╛", "рдзрд░реНрдорд╛рдиреНрддрд░рдг", "рдЕрд╡реИрдз/рдЕрдирд╛рдзрд┐рдХреГрдд рдкреНрд░рд╡рд╛рд╕реА", "рдХрдордЬреЛрд░ рдЖрд╕реВрдЪрдирд╛ рддрдВрддреНрд░", "рдЬрдирддрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рджрд╣реАрдирддрд╛", "рдкреБрд▓рд┐рд╕рдХрд░реНрдорд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЖрддреНрдорд╣рддреНрдпрд╛", "рдЯреНрд░рд╛рдВрд╕рдлрд░/рдкреЛрд╕реНрдЯрд┐рдВрдЧ рд╕реЗ рдЬреБреЬрд╛ рдЕрд╕рдВрддреЛрд╖", "рдЕрдиреБрдХрдВрдкрд╛ рдирд┐рдпреБрдХреНрддрд┐ рдирд╣реАрдВ рдорд┐рд▓рдирд╛", "рд╣рддреНрдпрд╛", "рдмрд▓рд╛рддреНрдХрд╛рд░", "рдбрдХреИрддреА", "рд▓реВрдЯ", "рдЧреИрдВрдЧрд╡рд╛рд░", "рдЪрд╛рдХреВрдмрд╛рдЬреА", "рдлрд╛рдпрд░рд┐рдВрдЧ", "рдЧреИрдВрдЧрд░реЗрдк", "рдЧреМ-рддрд╕реНрдХрд░реА", "рдорд╛рдирд╡ рддрд╕реНрдХрд░реА", "рдЧреБрдорд╖реБрджрд╛ рдмрдЪреНрдЪреЗ/рдорд╣рд┐рд▓рд╛"]
additional_police_crimes = ["рд╣рд┐рд░рд╛рд╕рдд рдореЗрдВ рдореМрдд", "рд╣рд┐рд░рд╛рд╕рдд рдореЗрдВ рдкреНрд░рддрд╛рдбрд╝рдирд╛", "рдиреНрдпрд╛рдпреЗрддрд░ рд╣рддреНрдпрд╛рдПрдВ", "рджреБрд░реБрдкрдпреЛрдЧ", "VIP рд╕рдВрд╕реНрдХреГрддрд┐", "рдиреИрддрд┐рдХ рдкреБрд▓рд┐рд╕рд┐рдВрдЧ", "рдЭреВрдареА рдореБрдарднреЗрдбрд╝", "рд░рд╛рдЬрдиреАрддрд┐рдХ рд╣рд╕реНрддрдХреНрд╖реЗрдк", "рдЬрд╛рдБрдЪ рдореЗрдВ рджреЗрд░реА", "рд╕рдмреВрддреЛрдВ рд╕реЗ рдЫреЗрдбрд╝рдЫрд╛рдбрд╝", "рдкрдХреНрд╖рдкрд╛рддрдкреВрд░реНрдг рдЬрд╛рдБрдЪ", "рдЬрдирддрд╛ рдХреЛ рдзрдордХрд╛рдирд╛"]
summarized_police_crimes = ["рд▓рд╛рдкрд░рд╡рд╛рд╣реА", "рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░", "рдЕрдорд╛рдирд╡реАрдпрддрд╛", "рдЙрддреНрдкреАрдбрд╝рди", "рд╕рдВрд░рдХреНрд╖рдг", "рдирд┐рд╖реНрдХреНрд░рд┐рдпрддрд╛", "рдлрд░реНрдЬреАрд╡рд╛рдбрд╝рд╛", "рд╖рдбреНрдпрдВрддреНрд░", "рдЙрд▓реНрд▓рдВрдШрди", "рд╣рддреНрдпрд╛", "рдмрд▓рд╛рддреНрдХрд╛рд░", "рд╣рд┐рдВрд╕рд╛", "рддрд╕реНрдХрд░реА", "рднреЗрджрднрд╛рд╡", "рдЖрддреНрдорд╣рддреНрдпрд╛", "рдЕрд╕рдВрддреБрд╖реНрдЯрд┐", "рдкреНрд░рддрд╛рдбрд╝рдирд╛", "рджреБрд░реБрдкрдпреЛрдЧ", "рдкрдХреНрд╖рдкрд╛рдд", "рдзрдордХреА"]
alternative_police_crimes = ["рдкреБрд▓рд┐рд╕рд┐рдпрд╛ рдЬрд╝реНрдпрд╛рджрддреА", "рдкреБрд▓рд┐рд╕ рджреБрд░рд╛рдЪрд╛рд░", "рдЕрд╡реИрдз рдкреБрд▓рд┐рд╕ рдХрд╛рд░реНрд░рд╡рд╛рдИ", "рдкреБрд▓рд┐рд╕ рдЙрддреНрдкреАрдбрд╝рди", "рдкреБрд▓рд┐рд╕ рдХреА рдорд┐рд▓реАрднрдЧрдд", "рдкреБрд▓рд┐рд╕ рдХреА рдЕрдирджреЗрдЦреА", "рдкреБрд▓рд┐рд╕ рдХреА рдирд┐рд╖реНрдХреНрд░рд┐рдпрддрд╛", "рдкреБрд▓рд┐рд╕ рджреНрд╡рд╛рд░рд╛ рдлрд░реНрдЬреА рдХреЗрд╕", "рдкреБрд▓рд┐рд╕ рд░рд┐рд╢реНрд╡рддрдЦреЛрд░реА", "рд╣рд┐рд░рд╛рд╕рдд рдореЗрдВ рдЕрддреНрдпрд╛рдЪрд╛рд░", "рдлрд░реНрдЬреА рдореБрдарднреЗрдбрд╝", "рдкреБрд▓рд┐рд╕ рдХрд╛ рд░рд╛рдЬрдиреАрддрд┐рдХрд░рдг", "рдЬрд╛рдБрдЪ рдореЗрдВ рд╡рд┐рд▓рдВрдм", "рд╕рдмреВрддреЛрдВ рд╕реЗ рдЦрд┐рд▓рд╡рд╛рдбрд╝", "рдЬрд╛рдБрдЪ рдореЗрдВ рдкрдХреНрд╖рдкрд╛рдд", "рдкреБрд▓рд┐рд╕ рджреНрд╡рд╛рд░рд╛ рдзрдордХреА"]
crimes_by_police = list(set(police_crime_types_input + police_crime_examples + additional_police_crimes + summarized_police_crimes + alternative_police_crimes))

chhattisgarh_districts = ["рдмрд╛рд▓реЛрдж", "рдмрд▓реМрджрд╛рдмрд╛рдЬрд╛рд░", "рдмрд▓рд░рд╛рдордкреБрд░", "рдмрд╕реНрддрд░", "рдмреЗрдореЗрддрд░рд╛", "рдмрд┐рд▓рд╛рд╕рдкреБрд░", "рджрдВрддреЗрд╡рд╛рдбрд╝рд╛", "рдзрдорддрд░реА", "рджреБрд░реНрдЧ", "рдЧреМрд░реЗрд▓рд╛-рдкреЗрдВрдбреНрд░рд╛-рдорд░рд╡рд╛рд╣реА", "рдЧрд░рд┐рдпрд╛рдмрдВрдж", "рдЬрд╛рдВрдЬрдЧреАрд░-рдЪрд╛рдВрдкрд╛", "рдЬрд╢рдкреБрд░", "рдХрд╡рд░реНрдзрд╛", "рдХрд╛рдВрдХреЗрд░", "рдХреЛрд░рдмрд╛", "рдХреЛрд░рд┐рдпрд╛", "рдорд╣рд╛рд╕рдореБрдВрдж", "рдореБрдВрдЧреЗрд▓реА", "рдирд╛рд░рд╛рдпрдгрдкреБрд░", "рд░рд╛рдпрдЧрдврд╝", "рд░рд╛рдпрдкреБрд░", "рд░рд╛рдЬрдирд╛рдВрджрдЧрд╛рдВрд╡", "рд╕реБрдХрдорд╛", "рд╕реВрд░рдЬрдкреБрд░", "рд╕рд░рдЧреБрдЬрд╛", "рдмреАрдЬрд╛рдкреБрд░", "рдХреЛрдВрдбрд╛рдЧрд╛рдВрд╡", "рдЦреИрд░рд╛рдЧрдврд╝-рдЫреБрдИрдЦрджрд╛рди-рдЧрдВрдбрдИ", "рдореЛрд╣рд▓рд╛-рдорд╛рдирдкреБрд░-рдЕрдВрдмрд╛рдЧрдврд╝ рдЪреМрдХреА", "рд╕рд╛рд░рдВрдЧрдврд╝-рдмрд┐рд▓рд╛рдИрдЧрдврд╝", "рдордиреАрдиреНрджреНрд░рдЧрдврд╝-рдЪрд┐рд░рдорд┐рд░реА-рднрд░рддрдкреБрд░"]

crime_severity_en = {"Murder": 10, "Attempt to Murder": 8, "Rape": 9, "Robbery": 7, "Assault": 5, "Theft": 3, "Other": 1}

crime_severity_hi = {"рд╣рддреНрдпрд╛": 10, "рд╣рддреНрдпрд╛ рдХрд╛ рдкреНрд░рдпрд╛рд╕": 8, "рдмрд▓рд╛рддреНрдХрд╛рд░": 9, "рдбрдХреИрддреА": 7, "рд╣рдорд▓рд╛": 5, "рдЪреЛрд░реА": 3, "рдЧреИрдВрдЧ": 8, "рдЧреИрдВрдЧрд╕реНрдЯрд░": 8, "рд╕рд╛рдореВрд╣рд┐рдХ рдЕрдкрд░рд╛рдз": 7, "рдмрдВрджреА": 6, "рдлрд┐рд░реМрддреА": 7, "рд╣рддреНрдпрд╛ рдХреА рдХреЛрд╢рд┐рд╢": 8, "рдЕрдиреНрдп": 1}

crime_type = ["рд╣рддреНрдпрд╛", "рд╣рддреНрдпрд╛ рдХрд╛ рдкреНрд░рдпрд╛рд╕", "рдмрд▓рд╛рддреНрдХрд╛рд░", "рдмрд▓рд╛рддреНрдХрд╛рд░ рдХрд╛ рдкреНрд░рдпрд╛рд╕", "рдЫреЗрдбрд╝рдЫрд╛рдбрд╝", "рджреБрд╖реНрдХрд░реНрдо", "рдЕрдкрд╣рд░рдг", "рдбрдХреИрддреА", "рд▓реВрдЯ", "рдЪреЛрд░реА", "рдЧреГрд╣рднреЗрджрди", "рдорд╛рд░рдкреАрдЯ", "рдзреЛрдЦрд╛рдзрдбрд╝реА", "рдардЧреА", "рдШреВрд╕рдЦреЛрд░реА", "рд╕рд╛рдЗрдмрд░ рдЕрдкрд░рд╛рдз", "рдирдХрд▓реА рдиреЛрдЯ", "рдирд╢реАрд▓реА рджрд╡рд╛рдУрдВ рдХреА рддрд╕реНрдХрд░реА", "рд╢рд░рд╛рдм рддрд╕реНрдХрд░реА", "рдорд╛рдирд╡ рддрд╕реНрдХрд░реА", "рдШрд░реЗрд▓реВ рд╣рд┐рдВрд╕рд╛", "рдЖрддрдВрдХрд╡рд╛рдж", "рджреЗрд╢рджреНрд░реЛрд╣", "рдзрд╛рд░реНрдорд┐рдХ рдЙрдиреНрдорд╛рдж", "рдирд╛рдмрд╛рд▓рд┐рдЧ рд╕реЗ рджреБрд╖реНрдХрд░реНрдо", "рдкрддреНрдирд┐ рдкрд░ рдЕрддреНрдпрд╛рдЪрд╛рд░", "рдЖрддреНрдорд╣рддреНрдпрд╛ рдХреЗ рд▓рд┐рдП рдЙрдХрд╕рд╛рдирд╛", "рдзрдордХреА рджреЗрдирд╛", "рдЕрд╡реИрдз рд╣рдерд┐рдпрд╛рд░ рд░рдЦрдирд╛", "рд╣рдерд┐рдпрд╛рд░реЛрдВ рдХреА рддрд╕реНрдХрд░реА", "рдЬреБрдЖ", "рдорд╛рджрдХ рдкрджрд╛рд░реНрде рддрд╕реНрдХрд░реА", "рдирд╢реАрд▓реА рджрд╡рд╛рдУрдВ рдХреА рддрд╕реНрдХрд░реА", "рддрд╕реНрдХрд░реА", "рдирдХреНрд╕рд▓реА", "рдЖрддреНрдорд╕рдорд░реНрдкрдг", "рдИрдирд╛рдореА", "рдкреБрдирд░реНрд╡рд╛рд╕ рдиреАрддрд┐", "рдорд╛рдУрд╡рд╛рдж", "рдЧрд╛рдВрдЬрд╛", "рдорд╛рджрдХ рдкрджрд╛рд░реНрде", "рдПрдирдбреАрдкреАрдПрд╕", "рдмрд┐рдХреНрд░реА", "рдЕрд╡реИрдз рдкрд░рд┐рд╡рд╣рди", "рдирдХреНрд╕рд▓рд╡рд╛рдж", "рджреЗрд╢рджреНрд░реЛрд╣", "рдЧреМ рд╣рддреНрдпрд╛", "рдЧреМ рддрд╕реНрдХрд░реА"]

crime_severity_sorted = {
    'рд╢рд░рд╛рдм рддрд╕реНрдХрд░реА': 6, 'рдЬреБрдЖ': 2, 'рдЧреМ рд╣рддреНрдпрд╛': 6, 'рдЧреМ рддрд╕реНрдХрд░реА': 5, 'рдирд╢реАрд▓реА рджрд╡рд╛рдУрдВ рдХреА рддрд╕реНрдХрд░реА': 9, 'рд╣рдерд┐рдпрд╛рд░реЛрдВ рдХреА рддрд╕реНрдХрд░реА': 9,
    'рдорд╛рджрдХ рдкрджрд╛рд░реНрде рддрд╕реНрдХрд░реА': 9, 'рдЕрд╡реИрдз рд╣рдерд┐рдпрд╛рд░ рд░рдЦрдирд╛': 8, 'рдПрдирдбреАрдкреАрдПрд╕': 8, 'рдорд╛рджрдХ рдкрджрд╛рд░реНрде': 7, 'рд╡рдиреНрдпрдЬреАрд╡ рддрд╕реНрдХрд░реА': 7,
    'рдЕрд╡реИрдз рдЙрддреНрдкрд╛рджреЛрдВ рдХреА рддрд╕реНрдХрд░реА': 7, 'рдлреЗрдВрдЯреЗрдирд┐рд▓': 4, 'рдПрдордбреА рдбреНрд░рдЧ': 4, 'рдореЗрдлреЗрдбреНрд░реЛрди': 4, 'рдХреЛрдХреАрди': 4, 'рдмреНрд░рд╛рдЙрди рд╢реБрдЧрд░': 4,
    'рд╣реЗрд░реЛрдЗрди': 4, 'рдЧрд╛рдВрдЬрд╛': 4, 'рдзрд╛рд░реНрдорд┐рдХ рдЙрдиреНрдорд╛рдж': 7, 'рдирдХрд▓реА рдиреЛрдЯ': 7, 'рдЖрддрдВрдХрд╡рд╛рдж': 10, 'рджреЗрд╢рджреНрд░реЛрд╣': 10, 'рдорд╛рдУрд╡рд╛рдж': 9,
    'рдирдХреНрд╕рд▓реА': 9, 'рдирдХреНрд╕рд▓рд╡рд╛рдж': 9, 'рдкреБрдирд░реНрд╡рд╛рд╕ рдиреАрддрд┐': 2, 'рд╕рд╛рдЗрдмрд░ рдЕрдкрд░рд╛рдз': 6, 'рдбрд┐рдЬрд┐рдЯрд▓ рдЧрд┐рд░рдлреНрддрд╛рд░реА': 2, 'рд╕рд╛рдЗрдмрд░ рдзреЛрдЦрд╛рдзрдбрд╝реА': 6,
    'рдбрдХреИрддреА': 9, 'рд▓реВрдЯ': 8, 'рдЧреГрд╣рднреЗрджрди': 6, 'рдзреЛрдЦрд╛рдзрдбрд╝реА': 6, 'рдЪреЛрд░реА': 5, 'рдардЧреА': 5, 'рд╕рд╛рдВрдкреНрд░рджрд╛рдпрд┐рдХ рд╣рддреНрдпрд╛': 6, 'рд╣рддреНрдпрд╛': 10,
    'рдмрд▓рд╛рддреНрдХрд╛рд░': 10, 'рджреБрд╖реНрдХрд░реНрдо': 10, 'рдорд╛рдирд╡ рддрд╕реНрдХрд░реА': 10, 'рдирд╛рдмрд╛рд▓рд┐рдЧ рд╕реЗ рджреБрд╖реНрдХрд░реНрдо': 10, 'рд╣рддреНрдпрд╛ рдХрд╛ рдкреНрд░рдпрд╛рд╕': 9,
    'рдмрд▓рд╛рддреНрдХрд╛рд░ рдХрд╛ рдкреНрд░рдпрд╛рд╕': 9, 'рдЕрдкрд╣рд░рдг': 8, 'рдШрд░реЗрд▓реВ рд╣рд┐рдВрд╕рд╛': 4, 'рдЖрддреНрдорд╣рддреНрдпрд╛ рдХреЗ рд▓рд┐рдП рдЙрдХрд╕рд╛рдирд╛': 4, 'рдЫреЗрдбрд╝рдЫрд╛рдбрд╝': 6,
    'рдорд╛рд░рдкреАрдЯ': 6, 'рдкрддреНрдирд┐ рдкрд░ рдЕрддреНрдпрд╛рдЪрд╛рд░': 7, 'рдзрдордХреА рджреЗрдирд╛': 5, 'рдИрдирд╛рдореА': 0, 'рдЕрд╡реИрдз рдкрд░рд┐рд╡рд╣рди': 0, 'рдмрд┐рдХреНрд░реА': 0, 'рдЖрддреНрдорд╕рдорд░реНрдкрдг': 0
}

weapons_keywords = ['рдкрд┐рд╕реНрддреМрд▓', 'рд░рд┐рд╡реЙрд▓реНрд╡рд░', 'рдмрдВрджреВрдХ', 'рдЪрд╛рдХреВ', 'рддрд▓рд╡рд╛рд░', 'рд╣рдерд┐рдпрд╛рд░']

score_match = [
    "рд╡реНрдпрд╛рдкрд╛рд░", "рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛", "рд╡рд╛рд╣рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ", "рд╣рдерд┐рдпрд╛рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ", "рдкреБрд▓рд┐рд╕ рдЕрдзрд┐рдХрд╛рд░рд┐рдпреЛрдВ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛",
    "рдкреНрд░рдореБрдЦ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛", "рд░рд╛рдЬрдиреАрддрд┐рдХ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛", "рдЕрдВрддрд░рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕рдВрдмрдВрдз", "рдЖрдкрд░рд╛рдзрд┐рдХ рдЧрд┐рд░реЛрд╣ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛",
    "рдЕрдВрддрд░реНрд░рд╛рдЬреНрдпреАрдп рдЧрд┐рд░реЛрд╣ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛", "рд░рд╛рдЬрдиреАрддрд┐рдХ рджрд▓реЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рдкреНрд░рдореБрдЦ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рдкрд╛рдБрдЪ рд╕реЗ рдЕрдзрд┐рдХ рдмрдЪреНрдЪреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд",
    "рдкрд╛рдБрдЪ рд╕реЗ рдЕрдзрд┐рдХ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рдЕрд╡реИрдз/рдирдХрд▓реА рд╢рд░рд╛рдм рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рд╕рд░рдХрд╛рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдпреЛрдВ рдФрд░ рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрд▓рд┐рдкреНрддрддрд╛",
    "рд╡рд┐рд╢реЗрд╖ рдЕрд╡рд╕рд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рдорд╣рд┐рд▓рд╛рдУрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд", "рдЕрдиреБрд╕реВрдЪрд┐рдд рдЬрд╛рддрд┐ рдФрд░ рдЕрдиреБрд╕реВрдЪрд┐рдд рдЬрдирдЬрд╛рддрд┐ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд",
    "рдЖрд░реЛрдкреА рдХреЗ рд╡рд┐рд░реБрджреНрдз рдкрд╣рд▓реЗ рд╕реЗ рдХреЛрдИ рд╕рдЬрд╛, FIR рдпрд╛ рдЪрд╛рд░реНрдЬрд╢реАрдЯ", "рдЖрд░реЛрдкреА рдпрд╛ рджреЛрд╖реА рдкрд░ рдЗрдирд╛рдо рдШреЛрд╖рд┐рдд рдерд╛",
    "рдкреАрдбрд╝рд┐рдд рдкрд╣рд▓реЗ рднреА рдЕрдкрд░рд╛рдз рдХрд╛ рд╢рд┐рдХрд╛рд░ рд░рд╣ рдЪреБрдХрд╛ рдерд╛", "рд╕рд╛рдЗрдмрд░ рдбреЛрдореЗрди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд"
]

occasion = {
    "рджреАрд╡рд╛рд▓реА": 10, "рд╣реЛрд▓реА": 10, "рдИрдж": 9, "рдХреНрд░рд┐рд╕рдорд╕": 8, "рд░рдХреНрд╖рд╛ рдмрдВрдзрди": 8, "рджрд╢рд╣рд░рд╛": 9, "рдИрдж-рдЙрд▓-рдЕрдЬрд╣рд╛ (рдмрдХрд░реАрдж)": 8,
    "рдирд╡рд░рд╛рддреНрд░рд┐": 8, "рдЧрдгреЗрд╢ рдЪрддреБрд░реНрдереА": 9, "рдордХрд░ рд╕рдВрдХреНрд░рд╛рдВрддрд┐": 7, "рд▓реЛрд╣рдбрд╝реА": 6, "рдмреИрд╕рд╛рдЦреА": 6, "рдорд╣рд╛рд╢рд┐рд╡рд░рд╛рддреНрд░рд┐": 7,
    "рдЧреБрд░реБ рдирд╛рдирдХ рдЬрдпрдВрддреА": 6, "рд░рд╛рдордирд╡рдореА": 6, "рдИрдж рдорд┐рд▓рд╛рдж-рдЙрди-рдирдмреА": 5, "рдЬрдиреНрдорд╛рд╖реНрдЯрдореА": 7, "рдмрд╕рдВрдд рдкрдВрдЪрдореА": 6, "рдЧреБрдб рдлреНрд░рд╛рдЗрдбреЗ": 5,
    "рдмреБрджреНрдз рдкреВрд░реНрдгрд┐рдорд╛": 5, "рдорд╣рд╛рд╡реАрд░ рдЬрдпрдВрддреА": 5, "рд╢рдм-рдП-рдмрд░рд╛рдд": 4, "рдУрдгрдо": 6, "рдкреЛрдВрдЧрд▓": 6, "рддреБрд▓рд╕реА рд╡рд┐рд╡рд╛рд╣": 3,
    "рдЫрда рдкреВрдЬрд╛": 7, "рдЗрдВрдЯрд░рдиреЗрд╢рдирд▓ рд╡реАрдордиреНрд╕ рдбреЗ": 4, "рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рджрд┐рд╡рд╕": 9, "рдЧрдгрддрдВрддреНрд░ рджрд┐рд╡рд╕": 9, "рдЧрд╛рдВрдзреА рдЬрдпрдВрддреА": 7,
    "рд╢рд╣реАрдж рджрд┐рд╡рд╕": 5, "рд╢рд╛рджреА": 10, "рд╕рдЧрд╛рдИ": 6, "рдЧреГрд╣ рдкреНрд░рд╡реЗрд╢": 6, "рдЙрдкрдирдпрди рд╕рдВрд╕реНрдХрд╛рд░": 5, "рдирд╛рдордХрд░рдг": 4,
    "рдЕрдВрддрд┐рдо рд╕рдВрд╕реНрдХрд╛рд░/рддреЗрд░рд╣рд╡реАрдВ": 8, "рдзрд╛рд░реНрдорд┐рдХ рдпрд╛рддреНрд░рд╛/рддреАрд░реНрде рдпрд╛рддреНрд░рд╛": 6, "рд░рд╛рдЬрдиреАрддрд┐рдХ рд░реИрд▓реА": 7, "рд╕реНрдХреВрд▓ рдХрд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо": 5,
    "рдХреЙрд▓реЗрдЬ рдлреЗрд╕реНрдЯ": 6, "рд▓реЛрдХрд▓ рдореЗрд▓рд╛": 5, "рдЦреЗрд▓рдХреВрдж рдХрд╛ рдЖрдпреЛрдЬрди": 6
}

ambikapur_police_stations = [
    "рдХреЛрддрд╡рд╛рд▓реА рдЕрдВрдмрд┐рдХрд╛рдкреБрд░",
    "рдЧрд╛рдВрдзреА рдирдЧрд░ рдерд╛рдирд╛",
    "рдорд╣рд┐рд▓рд╛ рдерд╛рдирд╛",
    "рджрд░рд┐рдорд╛ рдерд╛рдирд╛",
    "рдЙрдЬрд┐рдпрд╛рд░рдкреБрд░ рдерд╛рдирд╛",
    "рд╕реАрддрд╛рдкреБрд░ рдерд╛рдирд╛",
    "рд▓реБрдгреНрдбреНрд░рд╛ рдерд╛рдирд╛",
    "рдореИрдирдкрд╛рдЯ рдерд╛рдирд╛",
    "рдмрддреМрд▓реА рдерд╛рдирд╛",
    "рдУрдбрдЧреА рдерд╛рдирд╛",
    "рдЭрд╛рд░рдЦрдВрдбреА рдерд╛рдирд╛",
    "рдкреНрд░рддрд╛рдкрдкреБрд░ рдерд╛рдирд╛",
    "рд░рд╛рдЬрдкреБрд░ рдерд╛рдирд╛",
    "рдХреБрд╢рдореА рдерд╛рдирд╛",
    "рднрдЯрдЧрд╛рдВрд╡ рдерд╛рдирд╛",
    "рдмрд┐рд╢реНрд░рд╛рдордкреБрд░ рдерд╛рдирд╛",
    "рднрдЯрдЧрд╛рдВрд╡┬ардХреЛрдпрд▓рд░реА┬ардерд╛рдирд╛",
    "рдЕрднрдирдкреБрд░",
    "рдЖрдЬрд╛рдж рдЪреМрдХ",
    "рдЖрд░рдВрдЧ",
    "рдЙрд░рд▓рд╛",
    "рдЖрдорд╛рдирд╛рдХрд╛",
    "рд╕рд┐рд╡рд┐рд▓ рд▓рд╛рдЗрдиреНрд╕",
    "рдЯрд┐рдХрд░рд╛рдкрд╛рд░рд╛",
    "рдзрд░рд╕реАрд╡рд╛рдВ",
    "рджреЗрд╡реЗрдиреНрджреНрд░рдирдЧрд░",
    "рджреАрдирджрдпрд╛рд▓ рдирдЧрд░",
    "рдЧреЛрд▓ рдмрд╛рдЬрд╛рд░",
    "рдЧрдВрдЬ",
    "рдЧреЛрдмрд░рд╛ рдирд╡рд╛рдкрд╛рд░рд╛",
    "рдЧреБрдврд╝рд┐рдпрд╛рд░реА",
    "рдЦрдорддрд░рд╛рдИ",
    "рдЦрд░реЛрд░рд╛",
    "рдорд╛рдирд╛ рдХреИрдореНрдк",
    "рдореМрджрд╣рд╛рдкрд╛рд░рд╛",
    "рдордВрджрд┐рд░ рд╣рд╕реМрдж",
    "рддрд┐рд▓реНрджрд╛ рдиреЗрд╡рд░рд╛",
    "рдкреБрд░рд╛рдиреА рдмрд╕реНрддреА",
    "рдкрдВрдбрд░реА",
    "рдорд╣рд┐рд▓рд╛ рдерд╛рдирд╛",
    "рдХреЛрддрд╡рд╛рд▓реА",
    "рд░рд╛рдЬреЗрдВрджреНрд░рдирдЧрд░",
    "рд╕рд░рд╕реНрд╡рддреАрдирдЧрд░",
    "рддреЗрд▓реАрдмрд╛рдВрдзрд╛",
    "рд╡рд┐рдзрд╛рдирд╕рднрд╛",
    "рд░рд╛рдЦреА",
    "рдЕрдиреБрд╕реВрдЪрд┐рдд рдЬрд╛рддрд┐ рдХрд▓реНрдпрд╛рдг рд░рд╛рдпрдкреБрд░",
    "рдЕрдкрд░рд╛рдз рдЕрдиреНрд╡реЗрд╖рдг рд╡рд┐рднрд╛рдЧ, рдкреБрд▓рд┐рд╕ рдореБрдЦреНрдпрд╛рд▓рдп рд░рд╛рдпрдкреБрд░",
    "рд░рд╛рдЬреНрдп рд╕рд╛рдИрдмрд░ рдкреБрд▓рд┐рд╕ рдерд╛рдирд╛",
    "рдХрдмреАрд░ рдирдЧрд░",
    "рдореБрдЬрдЧрд╣рди",
    "рдП рдЯреА рдПрд╕",
    "рдЦрдореНрд╣рд╛рд░рдбреАрд╣",
    "рд╕рд╛рдпрдмрд░ рдкреБрд▓рд┐рд╕ рдерд╛рдирд╛, рд░реЗрдВрдЬ рд░рд╛рдпрдкреБрд░"
]


# Load NER model
model_name = "ai4bharat/IndicNER"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForTokenClassification.from_pretrained(model_name)
ner_pipeline = pipeline("ner", model=model, tokenizer=tokenizer, aggregation_strategy="simple")

def extract_date(text):
    # Convert Hindi digits to Western numerals
    hindi_to_num = str.maketrans("режрезреирейрекрелремренреореп", "0123456789")
    text = text.translate(hindi_to_num)

    # Match common date formats: dd/mm/yyyy, dd-mm-yyyy, dd.mm.yyyy, dd/mm/yy etc.
    match = re.search(r'\b\d{1,2}[-/.]\d{1,2}[-/.]\d{2,4}\b', text)
    return match.group() if match else "N/A"

def extract_district(text):
    for district in chhattisgarh_districts:
        if district in text:
            return district
    return "N/A"
    
def extract_police_station(text):
    for ps in ambikapur_police_stations:
        if ps in text:
            return ps
    return "N/A"    
    
    # Try both 'рдерд╛рдирд╛' and 'рдЪреМрдХреА'
    # match = re.search(r'(рдерд╛рдирд╛|рдЪреМрдХреА)\s+([^\nред:,]*)', text)
    # return f'{match.group(1)} {match.group(2).strip()}' if match else "N/A"

def extract_fir_number(text):
    match = re.search(r'(рдЕрдкрд░рд╛рдз рдХреНрд░рдорд╛рдВрдХ|FIR|рдПрдлрдЖрдИрдЖрд░)\s*[:\-]?\s*([0-9\/\-]+)', text)
    return match.group(2) if match else "N/A"

def extract_complainant(text):
    # List of common patterns to detect complainant in Hindi FIRs
    patterns = [
        r'рдкреНрд░рд╛рд░реНрдереА\s*[:-]?\s*([^\n]*)',
        r'рд╢рд┐рдХрд╛рдпрддрдХрд░реНрддрд╛\s*[:-]?\s*([^\n]*)',
        r'рдлрд░рд┐рдпрд╛рджреА\s*[:-]?\s*([^\n]*)',
        r'Complainant\s*[:-]?\s*([^\n]*)'
    ]
    
    for pattern in patterns:
        match = re.search(pattern, text)
        if match:
            matched_text = match.group(1).strip()
            words = re.findall(r'[\w\u0900-\u097F]+', matched_text)
            limited_words = words[:8]
            name = ' '.join(limited_words)
            if name:
                return name
    
    return "N/A"


def extract_accused(text):
    # List of regex patterns covering different common Hindi patterns
    patterns = [
        r'рдЧрд┐рд░рдлреНрддрд╛рд░ рдЖрд░реЛрдкреА\s*-\s*([^\n]*)',
        r'рдЖрд░реЛрдкреА рдХрд╛ рдирд╛рдо\s*[:-]?\s*([^\n]*)',
        r'рдЖрд░реЛрдкреА\s*[:-]?\s*([^\n]*)',
        # r'рдирд╛рдо\s*[:-]?\s*([^\n]*)',
        r'рдЕрднрд┐рдпреБрдХреНрдд\s*[:-]?\s*([^\n]*)'
    ]
    
    for pattern in patterns:
        match = re.search(pattern, text)
        if match:
            matched_text = match.group(1).strip()
            # Remove common suffixes like 'рдкрд┐рддрд╛', 'рдкреБрддреНрд░', etc.
            matched_text = re.split(r'рдкрд┐рддрд╛|рдкреБрддреНрд░|рдкрддрд┐|Father|Son|Husband', matched_text)[0].strip()
            # Extract words (Hindi, Latin letters, digits)
            words = re.findall(r'[\w\u0900-\u097F]+', matched_text)
            # Take at most first 5 words
            limited_words = words[:5]
            name = ' '.join(limited_words)
            if name:
                return name

    # Fallback: use NER (e.g., transformers pipeline)
    try:
        ner_results = ner_pipeline(text)
        persons = [ent['word'] for ent in ner_results if ent['entity_group'] == 'PER']
        if persons:
            return persons[0]
    except Exception:
        pass  # fail silently if NER isn't available

    return "N/A"

def extract_weapons(text):
    weapons_keyword = weapons_keywords
    found = [word for word in weapons_keyword if word in text]
    return ', '.join(found) if found else "N/A"

def extract_crime_type(text):
    for crime in crime_severity_sorted.keys():
        if crime in text:
            return crime
    return "N/A" 

def extract_score(text):
    score=0
    for i in score_match:
        if i in text:
            score += 1
    
    for i in occasion.keys():
        if i in text:
            score += occasion[i]
               
    word_to_number = {
            "рд╢реВрдиреНрдп": 0, "рдПрдХ": 1, "рджреЛ": 2, "рддреАрди": 3, "рдЪрд╛рд░": 4, "рдкрд╛рдВрдЪ": 5,
            "рдЫрд╣": 6, "рд╕рд╛рдд": 7, "рдЖрда": 8, "рдиреМ": 9, "рджрд╕": 10, "рдЧреНрдпрд╛рд░рд╣": 11,
            "рдмрд╛рд░рд╣": 12, "рддреЗрд░рд╣": 13, "рдЪреМрджрд╣": 14, "рдкрдВрджреНрд░рд╣": 15, "рд╕реЛрд▓рд╣": 16,
            "рд╕рддреНрд░рд╣": 17, "рдЕрдард╛рд░рд╣": 18, "рдЙрдиреНрдиреАрд╕": 19, "рдмреАрд╕": 20
        }

    def convert_hindi_numerals(s):
        return s.translate(str.maketrans('режрезреирейрекрелремренреореп', '0123456789'))

    def extract_number_from_words(w):
        return word_to_number.get(w.strip(), 0)

    crime = extract_crime_type(text)
    if crime in crime_severity_sorted:
        score += crime_severity_sorted[crime]

        if crime == "рд╕рд╛рдЗрдмрд░ рдзреЛрдЦрд╛рдзрдбрд╝реА":
            # рд▓рд╛рдЦ
            lakh = re.search(r'([\dрежрезреирейрекрелремренреореп]+|[рдЕ-рд╣]+)\s*рд▓рд╛рдЦ', text)
            if lakh:
                lakh_word = lakh.group(1)
                if lakh_word.isdigit() or all(ch in 'режрезреирейрекрелремренреореп' for ch in lakh_word):
                    lakh_value = convert_hindi_numerals(lakh_word)
                else:
                    lakh_value = extract_number_from_words(lakh_word)
                score += int(lakh_value) * 2
            # рдХрд░реЛрдбрд╝
            crore = re.search(r'([\dрежрезреирейрекрелремренреореп]+|[рдЕ-рд╣]+)\s*рдХрд░реЛрдбрд╝', text)
            if crore:
                crore_word = crore.group(1)
                if crore_word.isdigit() or all(ch in 'режрезреирейрекрелремренреореп' for ch in crore_word):
                    crore_value = convert_hindi_numerals(crore_word)
                else:
                    crore_value = extract_number_from_words(crore_word)
                score += int(crore_value) * 20

    return score
    
def extract_summary_string(text):
    heading = f"ЁЯЧЮ {extract_district(text)},  {extract_police_station(text)}{extract_date(text)}__рдкреНрд░рд╛рдердорд┐рдХреА рд╕рдВрдЦреНрдпрд╛ {extract_fir_number(text)}"
    summary = (
        f"{extract_accused(text)} рдХреЛ {extract_crime_type(text)} рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрд░реЛрдкреА рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред "
        f"рдЗрд╕ рдкреНрд░рдХрд░рдг рдореЗрдВ рд╢рд┐рдХрд╛рдпрддрдХрд░реНрддрд╛ рдХрд╛ рдирд╛рдо {extract_complainant(text)} рд╣реИред "
    ) 
    
    return heading,summary



def analyze_articles(article_list):
    all_info_2d_list = []
    for news in article_list:
        heading, summary = extract_summary_string(news)
        # crime_category = extract_crime_category(news)
        info_row = [
            extract_police_station(news),
            extract_district(news),
            extract_date(news),
            extract_fir_number(news),
            extract_complainant(news),
            extract_accused(news),
            extract_weapons(news),
            extract_crime_type(news),
            extract_score(news),
            heading,
            summary
            
        ]
        all_info_2d_list.append(info_row)
    return all_info_2d_list